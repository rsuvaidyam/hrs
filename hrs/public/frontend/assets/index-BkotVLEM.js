var Pe=Object.getOwnPropertySymbols;var ot=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var Re=(t,e)=>{var s={};for(var o in t)ot.call(t,o)&&e.indexOf(o)<0&&(s[o]=t[o]);if(t!=null&&Pe)for(var o of Pe(t))e.indexOf(o)<0&&rt.call(t,o)&&(s[o]=t[o]);return s};var nt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var w=(t,e,s)=>new Promise((o,r)=>{var n=u=>{try{l(s.next(u))}catch(a){r(a)}},i=u=>{try{l(s.throw(u))}catch(a){r(a)}},l=u=>u.done?o(u.value):Promise.resolve(u.value).then(n,i);l((s=s.apply(t,e)).next())});import{_ as B,D as Ge,a as _e,b as qe,S as at,r as d,w as V,c as x,o as b,d as L,e as y,f as _,g as S,p as we,h as ye,i as K,j as it,u as lt,k as v,l as z,m as he,t as ct,n as be,q as A,s as T,v as ut,x as dt,y as ht,z as N,A as Ve,B as j,F as Fe,C as fe,E as ft,G as mt,H as pt,I as gt,J as vt,K as Ye,L as Be,M as _t}from"./frappe-ui-CTr6-X4z.js";var $s=nt(te=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const wt={components:{Dialog:Ge,Button:_e,TextInput:qe,Spinner:at},setup(){const t=d(""),e=d([]),s=d(!1),o=d(!1),r=()=>w(this,null,function*(){}),n=()=>{console.log("Confirmed!"),o.value=!1};return V(t,r),{search:t,searchResults:e,searchLoader:s,dialog1:o,handleSearch:r,handleConfirm:n}}},Se=t=>(we("data-v-aa4e4482"),t=t(),ye(),t),yt={class:"relative"},bt=Se(()=>y("p",{class:"w-60 md:w-96 h-full rounded-md border-2 border-gray-400 cursor-pointer bg-white py-0.5 px-2 text-md"},"Search..",-1)),St=[bt],xt=Se(()=>y("h3",null,"Search All Products",-1)),$t={class:"flex flex-col gap-2 relative"},kt=Se(()=>y("div",{class:"h-full min-h-72 md:h-48 md:min-h-48"},null,-1));function At(t,e,s,o,r,n){const i=x("TextInput"),l=x("Spinner"),u=x("Dialog");return b(),L("div",yt,[y("label",{for:"search",onClick:e[0]||(e[0]=a=>o.dialog1=!0)},St),_(u,{modelValue:o.dialog1,"onUpdate:modelValue":e[2]||(e[2]=a=>o.dialog1=a)},{"body-title":S(()=>[xt]),"body-content":S(()=>[y("div",$t,[_(i,{modelValue:o.search,"onUpdate:modelValue":e[1]||(e[1]=a=>o.search=a),label:"search",id:"search",placeholder:"Search.."},null,8,["modelValue"]),_(l,{class:"w-4 absolute top-1.5 right-1.5"})]),kt]),_:1},8,["modelValue"])])}const Ct=B(wt,[["render",At],["__scopeId","data-v-aa4e4482"]]),Tt={components:{Button:_e,TextInput:qe,Dialog:Ge},data(){return{email:null,password:null}},setup(){const t=d(!1),e=d(!1);return{signinpop:t,loading:e}},inject:["$auth"],mounted(){return w(this,null,function*(){var t,e;(e=(t=this.$route)==null?void 0:t.query)!=null&&e.route&&(this.redirect_route=this.$route.query.route,this.$router.replace({query:null}))})},methods:{login(){return w(this,null,function*(){this.loading=!0,this.email&&this.password&&(yield this.$auth.login(this.email,this.password))&&(this.signinpop=!1,this.loading=!1,this.$router.push({name:"Home"}))})}}},jt=t=>(we("data-v-e8c50fab"),t=t(),ye(),t),Lt={class:"flex flex-col justify-around h-full"},Ot=jt(()=>y("h3",null,"Login to Sweetkart",-1)),It={class:"flex flex-col gap-2"};function Et(t,e,s,o,r,n){const i=x("Button"),l=x("TextInput"),u=x("Dialog");return b(),L("div",Lt,[_(i,{variant:"outline",theme:"gray",size:"md",onClick:e[0]||(e[0]=a=>o.signinpop=!0),type:"button"},{default:S(()=>[K(" Login ")]),_:1}),_(u,{modelValue:o.signinpop,"onUpdate:modelValue":e[4]||(e[4]=a=>o.signinpop=a)},{"body-title":S(()=>[Ot]),"body-content":S(()=>[y("div",It,[_(l,{modelValue:r.email,"onUpdate:modelValue":e[1]||(e[1]=a=>r.email=a),label:"email",placeholder:"example@mail.com"},null,8,["modelValue"]),_(l,{modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=a=>r.password=a),label:"Password",placeholder:"******",type:"password"},null,8,["modelValue"])])]),actions:S(()=>[_(i,{class:"w-full",variant:"outline",theme:"gray",loading:o.loading,size:"md",disabled:!1,onClick:e[3]||(e[3]=a=>n.login())},{default:S(()=>[K(" Login ")]),_:1},8,["loading"])]),_:1},8,["modelValue"])])}const Nt=B(Tt,[["render",Et],["__scopeId","data-v-e8c50fab"]]),Dt={inject:["$auth","$call"],components:{Button:_e,GlobalSearch:Ct,SingIn:Nt,Dropdown:it},setup(){const t=d(0),e=d(!1);d(!1);const s=lt(),o=()=>{sessionStorage.clear(),e.value=!e.value},r=v("$call"),n=v("$session"),i=v("$auth");return V(e,()=>w(this,null,function*(){try{const u=i.isLoggedIn&&(yield r("hrs.controllers.cart.cart_count",{usr:n.user}));t.value=u||0}catch(u){console.error(u),t.value=0}}),{immediate:!0}),{count:t,signOut:o,route:s}}},Mt=t=>(we("data-v-a2068813"),t=t(),ye(),t),Pt={class:"w-full fixed top-0 h-12 md:h-14 z-40 bg-gray-200 shadow-sm"},Rt={class:"px-3 md:px-8 flex justify-between items-center h-full max-w-[1600px] mx-auto w-full"},Vt={class:"flex items-center gap-3 md:gap-6"},Bt=Mt(()=>y("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[y("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})],-1)),Ht={key:0,class:"w-4 h-4 rounded-full bg-white border border-gray-900 absolute -top-1 -right-2 flex items-center justify-center bg-primary text-xs font-bold text-gray-700"};function Ut(t,e,s,o,r,n){var f,k,h;const i=x("router-link"),l=x("GlobalSearch"),u=x("Dropdown"),a=x("SingIn");return b(),L("div",Pt,[y("div",Rt,[_(i,{to:"/",class:"text-xl font-medium text-secondary cursor-pointer"},{default:S(()=>[K("HRS")]),_:1}),y("div",Vt,[_(l),((f=t.userDetails)==null?void 0:f.role)==="SELLER"||((k=t.userDetails)==null?void 0:k.role)==="ADMIN"?(b(),z(i,{key:0,to:"/dashboard",class:"border px-5 py-[7px] font-medium text-sm hidden md:block bg-white hover:bg-primary hover:text-white transition-all"},{default:S(()=>[K(" Dashboard ")]),_:1})):he("",!0),n.$auth.isLoggedIn?(b(),z(u,{key:1,options:[{label:"Profile",onClick:()=>{}},{label:"Logout",onClick:()=>{n.$auth.logout()}}],button:{label:(h=n.$auth.cookie.full_name)==null?void 0:h.split(" ")[0].split("")[0],variant:"outline",theme:"gray",size:"md"}},null,8,["options","button"])):(b(),z(a,{key:2})),o.route.path!=="/cart"?(b(),z(i,{key:3,to:"/cart",class:"order-1 md:order-2 relative"},{default:S(()=>[Bt,o.count>=1?(b(),L("span",Ht,ct(o.count),1)):he("",!0)]),_:1})):he("",!0)])])])}const Xt=B(Dt,[["render",Ut],["__scopeId","data-v-a2068813"]]);/**
 * Vue 3 Carousel 0.3.3
 * (c) 2024
 * @license MIT
 */const p={itemsToShow:1,itemsToScroll:1,modelValue:0,transition:300,autoplay:0,snapAlign:"center",wrapAround:!1,throttle:16,pauseAutoplayOnHover:!1,mouseDrag:!0,touchDrag:!0,dir:"ltr",breakpoints:void 0,i18n:{ariaNextSlide:"Navigate to next slide",ariaPreviousSlide:"Navigate to previous slide",ariaNavigateToSlide:"Navigate to slide {slideNumber}",ariaGallery:"Gallery",itemXofY:"Item {currentSlide} of {slidesCount}",iconArrowUp:"Arrow pointing upwards",iconArrowDown:"Arrow pointing downwards",iconArrowRight:"Arrow pointing to the right",iconArrowLeft:"Arrow pointing to the left"}},He={itemsToShow:{default:p.itemsToShow,type:Number},itemsToScroll:{default:p.itemsToScroll,type:Number},wrapAround:{default:p.wrapAround,type:Boolean},throttle:{default:p.throttle,type:Number},snapAlign:{default:p.snapAlign,validator(t){return["start","end","center","center-even","center-odd"].includes(t)}},transition:{default:p.transition,type:Number},breakpoints:{default:p.breakpoints,type:Object},autoplay:{default:p.autoplay,type:Number},pauseAutoplayOnHover:{default:p.pauseAutoplayOnHover,type:Boolean},modelValue:{default:void 0,type:Number},mouseDrag:{default:p.mouseDrag,type:Boolean},touchDrag:{default:p.touchDrag,type:Boolean},dir:{default:p.dir,validator(t){return["rtl","ltr"].includes(t)}},i18n:{default:p.i18n,type:Object},settings:{default(){return{}},type:Object}};function zt({config:t,slidesCount:e}){const{snapAlign:s,wrapAround:o,itemsToShow:r=1}=t;if(o)return Math.max(e-1,0);let n;switch(s){case"start":n=e-r;break;case"end":n=e-1;break;case"center":case"center-odd":n=e-Math.ceil((r-.5)/2);break;case"center-even":n=e-Math.ceil(r/2);break;default:n=0;break}return Math.max(n,0)}function Gt({config:t,slidesCount:e}){const{wrapAround:s,snapAlign:o,itemsToShow:r=1}=t;let n=0;if(s||r>e)return n;switch(o){case"start":n=0;break;case"end":n=r-1;break;case"center":case"center-odd":n=Math.floor((r-1)/2);break;case"center-even":n=Math.floor((r-2)/2);break;default:n=0;break}return n}function pe({val:t,max:e,min:s}){return e<s?t:Math.min(Math.max(t,s),e)}function qt({config:t,currentSlide:e,slidesCount:s}){const{snapAlign:o,wrapAround:r,itemsToShow:n=1}=t;let i=e;switch(o){case"center":case"center-odd":i-=(n-1)/2;break;case"center-even":i-=(n-2)/2;break;case"end":i-=n-1;break}return r?i:pe({val:i,max:s-n,min:0})}function Je(t){return t?t.reduce((e,s)=>{var o;return s.type===Fe?[...e,...Je(s.children)]:((o=s.type)===null||o===void 0?void 0:o.name)==="CarouselSlide"?[...e,s]:e},[]):[]}function Z({val:t,max:e,min:s=0}){return t>e?Z({val:t-(e+1),max:e,min:s}):t<s?Z({val:t+(e+1),max:e,min:s}):t}function Ft(t,e){let s;return e?function(...o){const r=this;s||(t.apply(r,o),s=!0,setTimeout(()=>s=!1,e))}:t}function Yt(t,e){let s;return function(...o){s&&clearTimeout(s),s=setTimeout(()=>{t(...o),s=null},e)}}function We(t="",e={}){return Object.entries(e).reduce((s,[o,r])=>s.replace(`{${o}}`,String(r)),t)}var Jt=be({name:"ARIA",setup(){const t=v("config",A(Object.assign({},p))),e=v("currentSlide",d(0)),s=v("slidesCount",d(0));return()=>j("div",{class:["carousel__liveregion","carousel__sr-only"],"aria-live":"polite","aria-atomic":"true"},We(t.i18n.itemXofY,{currentSlide:e.value+1,slidesCount:s.value}))}}),Wt=be({name:"Carousel",props:He,setup(t,{slots:e,emit:s,expose:o}){var r;const n=d(null),i=d([]),l=d(0),u=d(0),a=A(Object.assign({},p));let f=Object.assign({},p),k;const h=d((r=t.modelValue)!==null&&r!==void 0?r:0),se=d(0),xe=d(0),P=d(0),H=d(0);let R,oe;T("config",a),T("slidesCount",u),T("currentSlide",h),T("maxSlide",P),T("minSlide",H),T("slideWidth",l);function re(){k=Object.assign({},t.breakpoints),f=Object.assign(Object.assign(Object.assign({},f),t),{i18n:Object.assign(Object.assign({},f.i18n),t.i18n),breakpoints:void 0}),$e(f)}function G(){if(!k||!Object.keys(k).length)return;const c=Object.keys(k).map(m=>Number(m)).sort((m,C)=>+C-+m);let g=Object.assign({},f);c.some(m=>{const C=window.matchMedia(`(min-width: ${m}px)`).matches;return C&&(g=Object.assign(Object.assign({},g),k[m])),C}),$e(g)}function $e(c){Object.entries(c).forEach(([g,m])=>a[g]=m)}const ke=Yt(()=>{G(),q(),U()},16);function U(){if(!n.value)return;const c=n.value.getBoundingClientRect();l.value=c.width/a.itemsToShow}function q(){u.value<=0||(xe.value=Math.ceil((u.value-1)/2),P.value=zt({config:a,slidesCount:u.value}),H.value=Gt({config:a,slidesCount:u.value}),a.wrapAround||(h.value=pe({val:h.value,max:P.value,min:H.value})))}ut(()=>{dt(()=>U()),setTimeout(()=>U(),1e3),G(),je(),window.addEventListener("resize",ke,{passive:!0}),s("init")}),ht(()=>{oe&&clearTimeout(oe),R&&clearInterval(R),window.removeEventListener("resize",ke,{passive:!0})});let $=!1;const F={x:0,y:0},Y={x:0,y:0},O=A({x:0,y:0}),J=d(!1),ne=d(!1),et=()=>{J.value=!0},tt=()=>{J.value=!1};function Ae(c){["INPUT","TEXTAREA","SELECT"].includes(c.target.tagName)||($=c.type==="touchstart",$||c.preventDefault(),!(!$&&c.button!==0||I.value)&&(F.x=$?c.touches[0].clientX:c.clientX,F.y=$?c.touches[0].clientY:c.clientY,document.addEventListener($?"touchmove":"mousemove",Ce,!0),document.addEventListener($?"touchend":"mouseup",Te,!0)))}const Ce=Ft(c=>{ne.value=!0,Y.x=$?c.touches[0].clientX:c.clientX,Y.y=$?c.touches[0].clientY:c.clientY;const g=Y.x-F.x,m=Y.y-F.y;O.y=m,O.x=g},a.throttle);function Te(){const c=a.dir==="rtl"?-1:1,g=Math.sign(O.x)*.4,m=Math.round(O.x/l.value+g)*c;if(m&&!$){const C=Me=>{window.removeEventListener("click",C,!0)};window.addEventListener("click",C,!0)}E(h.value-m),O.x=0,O.y=0,ne.value=!1,document.removeEventListener($?"touchmove":"mousemove",Ce,!0),document.removeEventListener($?"touchend":"mouseup",Te,!0)}function je(){!a.autoplay||a.autoplay<=0||(R=setInterval(()=>{a.pauseAutoplayOnHover&&J.value||W()},a.autoplay))}function Le(){R&&(clearInterval(R),R=null),je()}const I=d(!1);function E(c){const g=a.wrapAround?c:pe({val:c,max:P.value,min:H.value});h.value===g||I.value||(s("slide-start",{slidingToIndex:c,currentSlideIndex:h.value,prevSlideIndex:se.value,slidesCount:u.value}),I.value=!0,se.value=h.value,h.value=g,oe=setTimeout(()=>{if(a.wrapAround){const m=Z({val:g,max:P.value,min:0});m!==h.value&&(h.value=m,s("loop",{currentSlideIndex:h.value,slidingToIndex:c}))}s("update:modelValue",h.value),s("slide-end",{currentSlideIndex:h.value,prevSlideIndex:se.value,slidesCount:u.value}),I.value=!1,Le()},a.transition))}function W(){E(h.value+a.itemsToScroll)}function ae(){E(h.value-a.itemsToScroll)}const Oe={slideTo:E,next:W,prev:ae};T("nav",Oe),T("isSliding",I);const Ie=N(()=>qt({config:a,currentSlide:h.value,slidesCount:u.value}));T("slidesToScroll",Ie);const st=N(()=>{const c=a.dir==="rtl"?-1:1,g=Ie.value*l.value*c;return{transform:`translateX(${O.x-g}px)`,transition:`${I.value?a.transition:0}ms`,margin:a.wrapAround?`0 -${u.value*l.value}px`:"",width:"100%"}});function Ee(){re(),G(),q(),U(),Le()}Object.keys(He).forEach(c=>{["modelValue"].includes(c)||V(()=>t[c],Ee)}),V(()=>t.modelValue,c=>{c!==h.value&&E(Number(c))}),V(u,q),s("before-init"),re();const Ne={config:a,slidesCount:u,slideWidth:l,next:W,prev:ae,slideTo:E,currentSlide:h,maxSlide:P,minSlide:H,middleSlide:xe};o({updateBreakpointsConfigs:G,updateSlidesData:q,updateSlideWidth:U,initDefaultConfigs:re,restartCarousel:Ee,slideTo:E,next:W,prev:ae,nav:Oe,data:Ne});const ie=e.default||e.slides,le=e.addons,De=A(Ne);return()=>{const c=Je(ie==null?void 0:ie(De)),g=(le==null?void 0:le(De))||[];c.forEach((ce,ue)=>ce.props.index=ue);let m=c;if(a.wrapAround){const ce=c.map((de,X)=>Ve(de,{index:-c.length+X,isClone:!0,key:`clone-before-${X}`})),ue=c.map((de,X)=>Ve(de,{index:c.length+X,isClone:!0,key:`clone-after-${X}`}));m=[...ce,...c,...ue]}i.value=c,u.value=Math.max(c.length,1);const C=j("ol",{class:"carousel__track",style:st.value,onMousedownCapture:a.mouseDrag?Ae:null,onTouchstartPassiveCapture:a.touchDrag?Ae:null},m),Me=j("div",{class:"carousel__viewport"},C);return j("section",{ref:n,class:{carousel:!0,"is-sliding":I.value,"is-dragging":ne.value,"is-hover":J.value,"carousel--rtl":a.dir==="rtl"},dir:a.dir,"aria-label":a.i18n.ariaGallery,tabindex:"0",onMouseenter:et,onMouseleave:tt},[Me,g,j(Jt)])}}}),Ue;(function(t){t.arrowUp="arrowUp",t.arrowDown="arrowDown",t.arrowRight="arrowRight",t.arrowLeft="arrowLeft"})(Ue||(Ue={}));const Kt=()=>{const t=v("config",A(Object.assign({},p))),e=v("maxSlide",d(1)),s=v("minSlide",d(1)),o=v("currentSlide",d(1)),r=v("nav",{}),n=l=>Z({val:o.value,max:e.value,min:0})===l,i=[];for(let l=s.value;l<e.value+1;l++){const u=j("button",{type:"button",class:{"carousel__pagination-button":!0,"carousel__pagination-button--active":n(l)},"aria-label":We(t.i18n.ariaNavigateToSlide,{slideNumber:l+1}),onClick:()=>r.slideTo(l)}),a=j("li",{class:"carousel__pagination-item",key:l},u);i.push(a)}return j("ol",{class:"carousel__pagination"},i)};var Zt=be({name:"CarouselSlide",props:{index:{type:Number,default:1},isClone:{type:Boolean,default:!1}},setup(t,{slots:e}){const s=v("config",A(Object.assign({},p))),o=v("currentSlide",d(0)),r=v("slidesToScroll",d(0)),n=v("isSliding",d(!1)),i=N(()=>t.index===o.value),l=N(()=>t.index===o.value-1),u=N(()=>t.index===o.value+1),a=N(()=>{const f=Math.floor(r.value),k=Math.ceil(r.value+s.itemsToShow-1);return t.index>=f&&t.index<=k});return()=>{var f;return j("li",{style:{width:`${100/s.itemsToShow}%`},class:{carousel__slide:!0,"carousel__slide--clone":t.isClone,"carousel__slide--visible":a.value,"carousel__slide--active":i.value,"carousel__slide--prev":l.value,"carousel__slide--next":u.value,"carousel__slide--sliding":n.value},"aria-hidden":!a.value},(f=e.default)===null||f===void 0?void 0:f.call(e,{isActive:i.value,isClone:t.isClone,isPrev:l.value,isNext:u.value,isSliding:n.value,isVisible:a.value}))}}});const Qt={class:"carousel-container"},es=["src","alt"],ts={__name:"Carousel",setup(t){const e=d([]),s=v("$call");return V(()=>w(this,null,function*(){try{const r=yield s("hrs.controllers.api.get_carousel",{});e.value=(r==null?void 0:r.images)||[]}catch(r){console.log(r)}}),{immediate:!0}),(r,n)=>(b(),L("div",Qt,[_(fe(Wt),{autoplay:2e3,"wrap-around":"true","dynamic-height":!0},{addons:S(()=>[_(fe(Kt))]),default:S(()=>[(b(!0),L(Fe,null,ft(e.value,i=>(b(),z(fe(Zt),{key:i._id},{default:S(()=>[y("img",{src:i.image,alt:i.mimetype,class:"carousel__item h-24"},null,8,es)]),_:2},1024))),128))]),_:1})]))}},ss=B(ts,[["__scopeId","data-v-79c7d731"]]),os={inject:["$auth"],components:{Navbar:Xt,Carousel:ss}},rs={class:"pt-12 md:pt-14"};function ns(t,e,s,o,r,n){const i=x("Navbar"),l=x("Carousel"),u=x("router-view");return b(),L("div",null,[_(i),y("div",rs,[_(l),_(u)])])}const as=B(os,[["render",ns]]),is={resources:{ping(){return{method:"frappe.ping",onSuccess(t){alert(t)}}}}},ls={class:"pt-16"},cs=y("h1",null,"Home Page",-1),us=[cs];function ds(t,e,s,o,r,n){return b(),L("div",ls,us)}const Ke=B(is,[["render",ds]]),hs=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"})),fs=[{path:"/",name:"Home",component:()=>mt(()=>Promise.resolve().then(()=>hs),void 0),meta:{isLoginPage:!1},props:!1}],ms=[{path:"/",name:"Home",component:Ke},...fs],D=pt({history:gt("/hrs"),routes:ms});function Q(t,e){return w(this,null,function*(){e||(e={});let s={Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname};window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(s["X-Frappe-CSRF-Token"]=window.csrf_token),r(this,"RequestStarted",null);const o=yield fetch(`/api/method/${t}`,{method:"POST",headers:s,body:JSON.stringify(e)});if(o.ok){r(this,null,null);const n=yield o.json();return n.docs||t==="login"?n:n.message}else{let n=yield o.text(),i,l;try{i=JSON.parse(n)}catch(f){}let u=[[t,i.exc_type,i._error_message].filter(Boolean).join(" ")];if(i.exc){l=i.exc;try{l=JSON.parse(l)[0]}catch(f){}u.push(l)}let a=new Error(u.join(`
`));throw a.exc_type=i.exc_type,a.exc=l,a.messages=i._server_messages?JSON.parse(i._server_messages):[],a.messages=a.messages.concat(i.message),a.messages=a.messages.map(f=>{try{return JSON.parse(f).message}catch(k){return f}}),a.messages=a.messages.filter(Boolean),a.messages.length||(a.messages=i._error_message?[i._error_message]:["Internal Server Error"]),r(this,null,a.messages.join(`
`)),[401,403].includes(o.status)&&D.currentRoute.name!=="Login"&&D.push("/login"),a}function r(n,i,l){(n==null?void 0:n.state)!==void 0&&(n.state=i),(n==null?void 0:n.errorMessage)!==void 0&&(n.errorMessage=l)}})}class ps{constructor(e,s){this._vm=e,this._watchers=[];let o=A({});for(let r in s){let n=s[r];if(typeof n=="function")this._watchers.push([()=>n.call(e),(i,l)=>this.updateResource(r,i,l),{immediate:!0,deep:!0,flush:"sync"}]);else{let i=new Xe(e,n);o[r]=d(i),i.auto&&i.reload()}}this.resources=o}init(){this._watchers=this._watchers.map(e=>this._vm.$watch(...e))}destroy(){const e=this._vm;delete e._rm}updateResource(e,s,o){let r;e in this.resources?r=this.resources[e]:(r=A(new Xe(this._vm,s)),this.resources[e]=r);let n=r.data;o&&r&&r.cancel(),r.update(s),r.keepData&&(r.data=n),r.auto&&r.reload()}}class Xe{constructor(e,s={}){if(typeof s=="string"&&(s={method:s,auto:!0}),!s.method)throw new Error("[Resource Manager]: method is required to define a resource");this._vm=e,this.method=s.method,this.delay=s.delay||0,this.update(s)}update(e){if(typeof e=="string"&&(e={method:e,auto:!0}),this.method&&e.method&&e.method!==this.method)throw new Error("[Resource Manager]: method cannot change for the same resource");this.options=e,this.params=e.params||null,this.auto=e.auto||!1,this.keepData=e.keepData||!1,this.condition=e.condition||(()=>!0),this.paged=e.paged||!1,this.validate=e.validate||null,this.validate&&(this.validate=this.validate.bind(this._vm)),this.listeners=Object.create(null),this.onceListeners=Object.create(null);let s=Object.keys(e).filter(o=>o.startsWith("on"));if(s.length>0)for(const o of s)this.on(o,e[o]);this.reset()}fetch(e){return w(this,null,function*(){if(this.condition()){if(this.loading=!0,this.currentParams=e||this.params,this.validate){let s=yield this.validate();if(s){this.setError(s),this.loading=!1;return}}try{let s=yield Q(this.method,this.currentParams);this.delay&&(yield new Promise(o=>setTimeout(o,this.delay*1e3))),Array.isArray(s)&&this.paged?(this.lastPageEmpty=s.length===0,this.data=[].concat(this.data||[],s)):this.data=s,this.emit("Success",this.data)}catch(s){let o=s.messages||["Internal Server Error"];this.setError(o.join(`
`))}this.lastLoaded=new Date,this.loading=!1,this.currentParams=null}})}reload(){return this.fetch()}submit(e){return this.fetch(e)}reset(){this.data=this.options.default||null,this.error=null,this.loading=!1,this.lastLoaded=null,this.lastPageEmpty=!1,this.currentParams=null}cancel(){}setError(e){this.error=e,this.emit("Error",this.error)}on(e,s){return this.listeners[e]=(this.listeners[e]||[]).concat(s),this}once(e,s){return this.onceListeners[e]=(this.onceListeners[e]||[]).concat(s),this}emit(e,...s){let o="on"+e,r=this._vm;(this.listeners[o]||[]).forEach(i=>{n(i)}),(this.onceListeners[o]||[]).forEach(i=>{n(i),this.onceListeners[o].splice(this.onceListeners[o].indexOf(i),1)});function n(i){try{i.call(r,...s)}catch(l){console.error(l)}}}}let gs={beforeCreate(){const t=this.$options;if(!t.resources||t._rm)return;let e;if(typeof t.resources=="function"&&(t.resources=t.resources.call(this)),_s(t.resources)){const s=t.resources,{$options:o}=s,r=Re(s,["$options"]);e=new ps(this,r)}else throw new Error("[ResourceManager]: resources options should be an object or a function that returns object");Object.prototype.hasOwnProperty.call(this,"$resources")||(this.$resources=A(e.resources)),Object.keys(t.resources).forEach(o=>{me(t.computed,o)||me(t.props,o)||me(t.methods,o)||(t.computed||(t.computed={}),t.computed[o]=t.resources[o])}),this._rm=e},data(){return this._rm?{$rm:this._rm,$r:this._rm.resources,$resources:this._rm.resources}:{}},created(){this._rm&&this._rm.init()}};function vs(t){t.mixin(gs)}function _s(t){return typeof t=="object"&&t&&Object.prototype.toString(t)==="[object Object]"}function me(t,e){return e in(t||{})}let ws=window.location.hostname,Ze=window.location.port?":9000":"",ys=Ze?"http":"https",bs=`${ys}://${ws}${Ze}`,Ss=vt(bs);class xs{constructor(){this.isLoggedIn=!1,this.user=null,this.user_image=null,this.cookie=null,this.cookie=Object.fromEntries(document.cookie.split("; ").map(e=>e.split("=")).map(e=>[e[0],decodeURIComponent(e[1])])),this.isLoggedIn=this.cookie.user_id&&this.cookie.user_id!=="Guest"}login(e,s){return w(this,null,function*(){let o=yield Q("login",{usr:e,pwd:s});return o?(this.isLoggedIn=!0,o):!1})}logout(){return w(this,null,function*(){yield Q("logout"),this.isLoggedIn=!1,window.location.reload()})}resetPassword(e){return w(this,null,function*(){console.log("resetting password")})}}const Qe=Ye({url:"hrms.api.get_current_user_info",cache:"hrms:user",onError(t){t&&t.exc_type==="AuthenticationError"&&D.push({name:"Login"})}});function ge(){let e=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return e==="Guest"&&(e=null),e}function ze(t){t.message==="Logged In"&&(Qe.reload(),ee.user=ge(),D.replace(t.default_route||"/"))}const ee=A({login:(t,e)=>w(te,null,function*(){const s=yield Be("login",{usr:t,pwd:e});return ze(s),s}),otp:(t,e)=>w(te,null,function*(){const s=yield Be("login",{tmp_id:t,otp:e});return ze(s),s}),logout:Ye({url:"logout",onSuccess(){Qe.reset(),ee.user=ge(),D.replace({name:"Login"}),window.location.reload()}}),user:ge(),isLoggedIn:N(()=>!!ee.user)}),M=_t(as),ve=A(new xs);M.use(D);M.use(vs);M.provide("$session",ee);M.provide("$auth",ve);M.provide("$call",Q);M.provide("$socket",Ss);D.beforeEach((t,e,s)=>w(te,null,function*(){t.matched.some(o=>!o.meta.isLoginPage)?ve.isLoggedIn?s():s({name:"Login",query:{route:t.path}}):ve.isLoggedIn?s({name:"Home"}):s()}));M.mount("#app")});export default $s();
//# sourceMappingURL=index-BkotVLEM.js.map

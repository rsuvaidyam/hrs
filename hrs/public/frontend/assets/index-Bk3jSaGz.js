var A=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var B=(t,e)=>{var o={};for(var s in t)X.call(t,s)&&e.indexOf(s)<0&&(o[s]=t[s]);if(t!=null&&A)for(var s of A(t))e.indexOf(s)<0&&Q.call(t,s)&&(o[s]=t[s]);return o};var Y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var d=(t,e,o)=>new Promise((s,r)=>{var a=c=>{try{l(o.next(c))}catch(i){r(i)}},n=c=>{try{l(o.throw(c))}catch(i){r(i)}},l=c=>c.done?s(c.value):Promise.resolve(c.value).then(a,n);l((o=o.apply(t,e)).next())});import{_ as x,D as q,a as R,b as z,S as ee,r as f,w as J,c as p,o as g,d as v,e as m,f as h,g as _,p as N,h as V,i as L,j as te,u as se,k as oe,l as re,m as G,n as S,q as O,t as ae,s as ne,v as ie,x as le,y as $,z as ce,A as F,B as T,C as ue}from"./frappe-ui-Be7jXmzM.js";var st=Y(j=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const de={components:{Dialog:q,Button:R,TextInput:z,Spinner:ee},setup(){const t=f(""),e=f([]),o=f(!1),s=f(!1),r=()=>d(this,null,function*(){}),a=()=>{console.log("Confirmed!"),s.value=!1};return J(t,r),{search:t,searchResults:e,searchLoader:o,dialog1:s,handleSearch:r,handleConfirm:a}}},C=t=>(N("data-v-aa4e4482"),t=t(),V(),t),he={class:"relative"},pe=C(()=>m("p",{class:"w-60 md:w-96 h-full rounded-md border-2 border-gray-400 cursor-pointer bg-white py-0.5 px-2 text-md"},"Search..",-1)),me=[pe],fe=C(()=>m("h3",null,"Search All Products",-1)),ge={class:"flex flex-col gap-2 relative"},_e=C(()=>m("div",{class:"h-full min-h-72 md:h-48 md:min-h-48"},null,-1));function we(t,e,o,s,r,a){const n=p("TextInput"),l=p("Spinner"),c=p("Dialog");return g(),v("div",he,[m("label",{for:"search",onClick:e[0]||(e[0]=i=>s.dialog1=!0)},me),h(c,{modelValue:s.dialog1,"onUpdate:modelValue":e[2]||(e[2]=i=>s.dialog1=i)},{"body-title":_(()=>[fe]),"body-content":_(()=>[m("div",ge,[h(n,{modelValue:s.search,"onUpdate:modelValue":e[1]||(e[1]=i=>s.search=i),label:"search",id:"search",placeholder:"Search.."},null,8,["modelValue"]),h(l,{class:"w-4 absolute top-1.5 right-1.5"})]),_e]),_:1},8,["modelValue"])])}const ye=x(de,[["render",we],["__scopeId","data-v-aa4e4482"]]),be={components:{Button:R,TextInput:z,Dialog:q},data(){return{email:null,password:null}},setup(){const t=f(!1),e=f(!1);return{signinpop:t,loading:e}},inject:["$auth"],mounted(){return d(this,null,function*(){var t,e;(e=(t=this.$route)==null?void 0:t.query)!=null&&e.route&&(this.redirect_route=this.$route.query.route,this.$router.replace({query:null}))})},methods:{login(){return d(this,null,function*(){this.loading=!0,this.email&&this.password&&(yield this.$auth.login(this.email,this.password))&&(this.signinpop=!1,this.loading=!1,this.$router.push({name:"Home"}))})}}},ve=t=>(N("data-v-e8c50fab"),t=t(),V(),t),$e={class:"flex flex-col justify-around h-full"},xe=ve(()=>m("h3",null,"Login to Sweetkart",-1)),Se={class:"flex flex-col gap-2"};function Le(t,e,o,s,r,a){const n=p("Button"),l=p("TextInput"),c=p("Dialog");return g(),v("div",$e,[h(n,{variant:"outline",theme:"gray",size:"md",onClick:e[0]||(e[0]=i=>s.signinpop=!0),type:"button"},{default:_(()=>[L(" Login ")]),_:1}),h(c,{modelValue:s.signinpop,"onUpdate:modelValue":e[4]||(e[4]=i=>s.signinpop=i)},{"body-title":_(()=>[xe]),"body-content":_(()=>[m("div",Se,[h(l,{modelValue:r.email,"onUpdate:modelValue":e[1]||(e[1]=i=>r.email=i),label:"email",placeholder:"example@mail.com"},null,8,["modelValue"]),h(l,{modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=i=>r.password=i),label:"Password",placeholder:"******",type:"password"},null,8,["modelValue"])])]),actions:_(()=>[h(n,{class:"w-full",variant:"outline",theme:"gray",loading:s.loading,size:"md",disabled:!1,onClick:e[3]||(e[3]=i=>a.login())},{default:_(()=>[L(" Login ")]),_:1},8,["loading"])]),_:1},8,["modelValue"])])}const ke=x(be,[["render",Le],["__scopeId","data-v-e8c50fab"]]),Ie={inject:["$auth","$call"],components:{Button:R,GlobalSearch:ye,SingIn:ke,Dropdown:te},setup(){const t=f(0),e=f(!1),o=f(!1),s=f(JSON.parse(sessionStorage.getItem("userDetails")||"{}")),r=se(),a=()=>{sessionStorage.clear(),e.value=!e.value},n=()=>{o.value=!o.value},l=oe("$call");J(e,()=>d(this,null,function*(){try{const u=yield l("hrs/apis/cart/get_cart_items",{});t.value=(u==null?void 0:u.count)||0}catch(u){console.error(u),t.value=0}}),{immediate:!0}),re(()=>{s.value=JSON.parse(sessionStorage.getItem("userDetails")||"{}")});const i=G(()=>{var u,b;return(b=(u=s.value)==null?void 0:u.name)==null?void 0:b.split(" ")[0]});return{count:t,signOut:a,toggleLogin:n,userDetails:s,route:r,firstName:i}}},je=t=>(N("data-v-8d30dc6d"),t=t(),V(),t),Oe={class:"w-full fixed top-0 h-12 md:h-14 z-40 bg-gray-200 shadow-sm"},Pe={class:"px-3 md:px-8 flex justify-between items-center h-full max-w-[1600px] mx-auto w-full"},Ee={class:"flex items-center gap-3 md:gap-6"},De=je(()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})],-1)),Re={key:0,class:"w-4 h-4 rounded-full absolute -top-1 -right-2 flex items-center justify-center bg-primary text-xs font-bold text-gray-700"};function Ne(t,e,o,s,r,a){var u,b,M;const n=p("router-link"),l=p("GlobalSearch"),c=p("Dropdown"),i=p("SingIn");return g(),v("div",Oe,[m("div",Pe,[h(n,{to:"/",class:"text-xl font-medium text-secondary cursor-pointer"},{default:_(()=>[L("HRS")]),_:1}),m("div",Ee,[h(l),((u=s.userDetails)==null?void 0:u.role)==="SELLER"||((b=s.userDetails)==null?void 0:b.role)==="ADMIN"?(g(),S(n,{key:0,to:"/dashboard",class:"border px-5 py-[7px] font-medium text-sm hidden md:block bg-white hover:bg-primary hover:text-white transition-all"},{default:_(()=>[L(" Dashboard ")]),_:1})):O("",!0),a.$auth.isLoggedIn?(g(),S(c,{key:1,options:[{label:"Profile",onClick:()=>{}},{label:"Logout",onClick:()=>{a.$auth.logout()}}],button:{label:(M=a.$auth.cookie.full_name)==null?void 0:M.split(" ")[0].split("")[0],variant:"outline",theme:"gray",size:"md"}},null,8,["options","button"])):(g(),S(i,{key:2})),s.route.path!=="/cart"?(g(),S(n,{key:3,to:"/cart",class:"order-1 md:order-2 relative"},{default:_(()=>[De,s.count>=1?(g(),v("span",Re,ae(s.count),1)):O("",!0)]),_:1})):O("",!0)])])])}const Ve=x(Ie,[["render",Ne],["__scopeId","data-v-8d30dc6d"]]),Ce={inject:["$auth"],components:{Navbar:Ve}};function Me(t,e,o,s,r,a){const n=p("Navbar"),l=p("router-view");return g(),v("div",null,[h(n),h(l)])}const Ae=x(Ce,[["render",Me]]),Be={resources:{ping(){return{method:"frappe.ping",onSuccess(t){alert(t)}}}}},Te={class:"pt-16"},He=m("h1",null,"Home Page",-1),Ue=[He];function qe(t,e,o,s,r,a){return g(),v("div",Te,Ue)}const K=x(Be,[["render",qe]]),ze=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),Je=[{path:"/",name:"Home",component:()=>ne(()=>Promise.resolve().then(()=>ze),void 0),meta:{isLoginPage:!1},props:!1}],Ge=[{path:"/",name:"Home",component:K},...Je],w=ie({history:le("/hrs"),routes:Ge});function k(t,e){return d(this,null,function*(){e||(e={});let o={Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname};window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(o["X-Frappe-CSRF-Token"]=window.csrf_token),r(this,"RequestStarted",null);const s=yield fetch(`/api/method/${t}`,{method:"POST",headers:o,body:JSON.stringify(e)});if(s.ok){r(this,null,null);const a=yield s.json();return a.docs||t==="login"?a:a.message}else{let a=yield s.text(),n,l;try{n=JSON.parse(a)}catch(u){}let c=[[t,n.exc_type,n._error_message].filter(Boolean).join(" ")];if(n.exc){l=n.exc;try{l=JSON.parse(l)[0]}catch(u){}c.push(l)}let i=new Error(c.join(`
`));throw i.exc_type=n.exc_type,i.exc=l,i.messages=n._server_messages?JSON.parse(n._server_messages):[],i.messages=i.messages.concat(n.message),i.messages=i.messages.map(u=>{try{return JSON.parse(u).message}catch(b){return u}}),i.messages=i.messages.filter(Boolean),i.messages.length||(i.messages=n._error_message?[n._error_message]:["Internal Server Error"]),r(this,null,i.messages.join(`
`)),[401,403].includes(s.status)&&w.currentRoute.name!=="Login"&&w.push("/login"),i}function r(a,n,l){(a==null?void 0:a.state)!==void 0&&(a.state=n),(a==null?void 0:a.errorMessage)!==void 0&&(a.errorMessage=l)}})}class Fe{constructor(e,o){this._vm=e,this._watchers=[];let s=$({});for(let r in o){let a=o[r];if(typeof a=="function")this._watchers.push([()=>a.call(e),(n,l)=>this.updateResource(r,n,l),{immediate:!0,deep:!0,flush:"sync"}]);else{let n=new H(e,a);s[r]=f(n),n.auto&&n.reload()}}this.resources=s}init(){this._watchers=this._watchers.map(e=>this._vm.$watch(...e))}destroy(){const e=this._vm;delete e._rm}updateResource(e,o,s){let r;e in this.resources?r=this.resources[e]:(r=$(new H(this._vm,o)),this.resources[e]=r);let a=r.data;s&&r&&r.cancel(),r.update(o),r.keepData&&(r.data=a),r.auto&&r.reload()}}class H{constructor(e,o={}){if(typeof o=="string"&&(o={method:o,auto:!0}),!o.method)throw new Error("[Resource Manager]: method is required to define a resource");this._vm=e,this.method=o.method,this.delay=o.delay||0,this.update(o)}update(e){if(typeof e=="string"&&(e={method:e,auto:!0}),this.method&&e.method&&e.method!==this.method)throw new Error("[Resource Manager]: method cannot change for the same resource");this.options=e,this.params=e.params||null,this.auto=e.auto||!1,this.keepData=e.keepData||!1,this.condition=e.condition||(()=>!0),this.paged=e.paged||!1,this.validate=e.validate||null,this.validate&&(this.validate=this.validate.bind(this._vm)),this.listeners=Object.create(null),this.onceListeners=Object.create(null);let o=Object.keys(e).filter(s=>s.startsWith("on"));if(o.length>0)for(const s of o)this.on(s,e[s]);this.reset()}fetch(e){return d(this,null,function*(){if(this.condition()){if(this.loading=!0,this.currentParams=e||this.params,this.validate){let o=yield this.validate();if(o){this.setError(o),this.loading=!1;return}}try{let o=yield k(this.method,this.currentParams);this.delay&&(yield new Promise(s=>setTimeout(s,this.delay*1e3))),Array.isArray(o)&&this.paged?(this.lastPageEmpty=o.length===0,this.data=[].concat(this.data||[],o)):this.data=o,this.emit("Success",this.data)}catch(o){let s=o.messages||["Internal Server Error"];this.setError(s.join(`
`))}this.lastLoaded=new Date,this.loading=!1,this.currentParams=null}})}reload(){return this.fetch()}submit(e){return this.fetch(e)}reset(){this.data=this.options.default||null,this.error=null,this.loading=!1,this.lastLoaded=null,this.lastPageEmpty=!1,this.currentParams=null}cancel(){}setError(e){this.error=e,this.emit("Error",this.error)}on(e,o){return this.listeners[e]=(this.listeners[e]||[]).concat(o),this}once(e,o){return this.onceListeners[e]=(this.onceListeners[e]||[]).concat(o),this}emit(e,...o){let s="on"+e,r=this._vm;(this.listeners[s]||[]).forEach(n=>{a(n)}),(this.onceListeners[s]||[]).forEach(n=>{a(n),this.onceListeners[s].splice(this.onceListeners[s].indexOf(n),1)});function a(n){try{n.call(r,...o)}catch(l){console.error(l)}}}}let Ke={beforeCreate(){const t=this.$options;if(!t.resources||t._rm)return;let e;if(typeof t.resources=="function"&&(t.resources=t.resources.call(this)),We(t.resources)){const o=t.resources,{$options:s}=o,r=B(o,["$options"]);e=new Fe(this,r)}else throw new Error("[ResourceManager]: resources options should be an object or a function that returns object");Object.prototype.hasOwnProperty.call(this,"$resources")||(this.$resources=$(e.resources)),Object.keys(t.resources).forEach(s=>{P(t.computed,s)||P(t.props,s)||P(t.methods,s)||(t.computed||(t.computed={}),t.computed[s]=t.resources[s])}),this._rm=e},data(){return this._rm?{$rm:this._rm,$r:this._rm.resources,$resources:this._rm.resources}:{}},created(){this._rm&&this._rm.init()}};function Ze(t){t.mixin(Ke)}function We(t){return typeof t=="object"&&t&&Object.prototype.toString(t)==="[object Object]"}function P(t,e){return e in(t||{})}let Xe=window.location.hostname,Z=window.location.port?":9000":"",Qe=Z?"http":"https",Ye=`${Qe}://${Xe}${Z}`,et=ce(Ye);class tt{constructor(){this.isLoggedIn=!1,this.user=null,this.user_image=null,this.cookie=null,this.cookie=Object.fromEntries(document.cookie.split("; ").map(e=>e.split("=")).map(e=>[e[0],decodeURIComponent(e[1])])),this.isLoggedIn=this.cookie.user_id&&this.cookie.user_id!=="Guest"}login(e,o){return d(this,null,function*(){let s=yield k("login",{usr:e,pwd:o});return s?(this.isLoggedIn=!0,s):!1})}logout(){return d(this,null,function*(){yield k("logout"),this.isLoggedIn=!1,window.location.reload()})}resetPassword(e){return d(this,null,function*(){console.log("resetting password")})}}const W=F({url:"hrms.api.get_current_user_info",cache:"hrms:user",onError(t){t&&t.exc_type==="AuthenticationError"&&w.push({name:"Login"})}});function E(){let e=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return e==="Guest"&&(e=null),e}function U(t){t.message==="Logged In"&&(W.reload(),I.user=E(),w.replace(t.default_route||"/"))}const I=$({login:(t,e)=>d(j,null,function*(){const o=yield T("login",{usr:t,pwd:e});return U(o),o}),otp:(t,e)=>d(j,null,function*(){const o=yield T("login",{tmp_id:t,otp:e});return U(o),o}),logout:F({url:"logout",onSuccess(){W.reset(),I.user=E(),w.replace({name:"Login"}),window.location.reload()}}),user:E(),isLoggedIn:G(()=>!!I.user)}),y=ue(Ae),D=$(new tt);y.use(w);y.use(Ze);y.provide("$session",I);y.provide("$auth",D);y.provide("$call",k);y.provide("$socket",et);w.beforeEach((t,e,o)=>d(j,null,function*(){t.matched.some(s=>!s.meta.isLoginPage)?D.isLoggedIn?o():o({name:"Login",query:{route:t.path}}):D.isLoggedIn?o({name:"Home"}):o()}));y.mount("#app")});export default st();
//# sourceMappingURL=index-Bk3jSaGz.js.map
